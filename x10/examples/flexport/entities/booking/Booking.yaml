name: Booking
description: A pre-<Shipment>. An intention to ship goods containing most of the information necessary to eventually generate a <Shipment>

attributes:
  - name: name
    dataType: String
    mandatory: true
    placeholderText: Description of shipment

  - name: state
    dataType: BookingState
    mandatory: true

  - name: transportationMode
    dataType: TransportationMode
    mandatory: true

  - name: cargoReadyDate
    dataType: Date
    mandatory: true

  - name: targetDeliveryDate
    dataType: Date

  - name: notifyParty
    dataType: String
    toolTip: The company entity which should be notified of the arrival of the cargo
    ui: TextArea

  - name: isLcl
    dataType: Boolean
    mandatory: true
    default: false
    label: Shipment Type
    ui: BooleanViaButtons

# FUTURE I can forsee many cases (such as this one) where we'd like to include specific 
# UI paremeters in the entities definitions. The danger here is that this may tie
# the Entity definition too closesly to a particular UI library definition (which would be bad)
# So we must use semantic-level attributes, not UI-specific ones.
# Having said that, one can imagine a generic definition of an abstract BooleanViaButtons component
# which has a number of parameters - such as the ones below.
# If that were the case, what's the best way to specify such parameters? 
# 1) The dot notation is one option
# 2) Another option (perhaps more clean) would be a has option:
# ui: 
#   element: BooleanViaButtons
#   trueLabel: LCL
#   falseLabel: FCL
#
# In that case, "ui: BooleanViaButons" becomes a shorthand for the above with all attributes 
# set as their default values
#
#    ui.trueLabel: "LCL"
#    ui.falseLabel: "FCL"

  - name: incoterms
    dataType: Incoterms
    mandatory: true

  - name: wantsOriginService
    dataType: Boolean
    default: true

  - name: wantsExportCustomsService
    dataType: Boolean
    default: false

  - name: descriptionOfProducts
    dataType: String
    ui: TextArea
    applicableWhen: transportationMode == 'truck'
    toolTip: Please enter a short and concise description of products in this shipment

  - name: specialInstructions
    dataType: String
    ui: TextArea
    placeholderText: Enter any special instructions, such as handling information

derivedAttributes:
  - name: isShipperBooking
    dataType: Boolean
    formula: =shipper == $user.company

  - name: isConsigneeBooking
    dataType: Boolean
    formula: =consignee == $user.company

  - name: requiresChineseProductDescription
    dataType: Boolean
    formula: =isShipperBooking && company.countryCode == 'CN'


enums:
  - name: BookingState
    values:
      - value: draft
        label: Draft
        icon: draft
      - value: waitingForPricing
        label: Waiting For Pricing
        icon: dollar_sign
      - value: awaitingReview
        label: Awaiting Your Review
        icon: ticket

associations:
  - name: shipper
    dataType: Company
    mandatory: true
  - name: consignee
    dataType: Company
    mandatory: true
  - name: originLocation
    dataType: Location
    mandatory: true
  - name: originPort
    dataType: Port
  - name: destinationLocation
    dataType: Location
  - name: destinationPort
    dataType: Port
  - name: cargo
    dataType: Cargo
    owns: true
    mandatory: true
  - name: bookingHsCodes
    dataType: BookingHsCode
    owns: true
    many: true
    mandatory: true
    applicableWhen: transportationMode != 'truck'
  - name: metadata
    dataType: MetadataValue
    owns: true
    many: true
    ui: MetadataEditor

      

    

      